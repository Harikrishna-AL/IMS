{% extends 'base.html'%}



{% block content %}
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- <link rel="stylesheet" href="index.css"> -->

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<style>
	body {
		background: rgb(37, 43, 53);
	}

	h {
		color: antiquewhite;
	}

	.flex-container {
		display: flex;
		width: 100%;
		height: auto;
		padding: 10px;
		margin-bottom: auto;
		justify-content: center;
		/* background-color: rgb(182, 185, 216); */
	}

	.vertical-container {
		display: flex;
		width: 100%;
		height: auto;
		padding: 10px;
		margin-bottom: auto;
		justify-content: center;
		flex-direction: column;
	}

	.container {
		background-color: #31384d;
		margin: 10px;
		padding: 20px;
		font-size: 30px;
		border-radius: 20px;
	}

	canvas {
		align-self: center;
	}

	.Test_DatetimeLocal {
		align-self: center;
		height: min-content;
		width: min-content;
	}
/* CSS */
.button-17 {
  align-items: center;
  appearance: none;
  background-color: #fff;
  border-radius: 24px;
  border-style: none;
  box-shadow: rgba(0, 0, 0, .2) 0 3px 5px -1px,rgba(0, 0, 0, .14) 0 6px 10px 0,rgba(0, 0, 0, .12) 0 1px 18px 0;
  box-sizing: border-box;
  color: #3c4043;
  cursor: pointer;
  display: inline-flex;
  fill: currentcolor;
  font-family: "Google Sans",Roboto,Arial,sans-serif;
  font-size: 14px;
  font-weight: 500;
  height: 48px;
  justify-content: center;
  letter-spacing: .25px;
  line-height: normal;
  max-width: 100%;
  overflow: visible;
  padding: 2px 24px;
  position: relative;
  text-align: center;
  text-transform: none;
  transition: box-shadow 280ms cubic-bezier(.4, 0, .2, 1),opacity 15ms linear 30ms,transform 270ms cubic-bezier(0, 0, .2, 1) 0ms;
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  width: auto;
  will-change: transform,opacity;
  z-index: 0;
}

.button-17:hover {
  background: #F6F9FE;
  color: #174ea6;
}

.button-17:active {
  box-shadow: 0 4px 4px 0 rgb(60 64 67 / 30%), 0 8px 12px 6px rgb(60 64 67 / 15%);
  outline: none;
}

.button-17:focus {
  outline: none;
  border: 2px solid #4285f4;
}

.button-17:not(:disabled) {
  box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
}

.button-17:not(:disabled):hover {
  box-shadow: rgba(60, 64, 67, .3) 0 2px 3px 0, rgba(60, 64, 67, .15) 0 6px 10px 4px;
}

.button-17:not(:disabled):focus {
  box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
}

.button-17:not(:disabled):active {
  box-shadow: rgba(60, 64, 67, .3) 0 4px 4px 0, rgba(60, 64, 67, .15) 0 8px 12px 6px;
}

.button-17:disabled {
  box-shadow: rgba(60, 64, 67, .3) 0 1px 3px 0, rgba(60, 64, 67, .15) 0 4px 8px 3px;
}
	
</style>
<div class="app-container">
	<div class="vertical-container">
		<div class="flex-container" style="justify-content: flex-start;">
			<div class="container" style="height:35%; width:100%">
				<h>Inventory management system</h>
				
			</div>
			<div class="container" style="height:35%; width:100%">
				<!-- {% for date,ticket in report_data.items %}
				<h class="date">{{date}}</h>
				{% if date == '22/12/2022'%}
				<h class="ticket_Data">{{ticket}}</h>
				{% endif %}
				{% endfor %} -->

			</div>
			<div class="container" style="height:35%; width:100%">
				<!-- <input type="datetime-local" class="Test_DatetimeLocal" style="background-color:#515d79; color: rgb(128, 184, 233);text-align: center;"> -->
				<div style="align-self: center;">
				<input type="date" id="meeting-time" name="meeting-time"  value="2022-06-12">
				<button class="button-17" onclick="buttonClick()">Submit</button>
				</div>
			</div>
		</div>

		<div class="flex-container">

			<div class="container" style="height:50vh; width:100%">
				<div style="height:100%; width:100%; position: relative;">

					<canvas id="myChartline"></canvas>
				</div>

			</div>
			<div class="container" style="height:50vh; width:100%">
				<div style="height:100%; width:100%">

					<canvas id="myChartBar"></canvas>
				</div>

			</div>
		</div>
	</div>

</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
<script>

	function dateformat(date){
		var date = new Date(date);
		var month = date.getMonth() + 1;
		var day = date.getDate();
		var year = date.getFullYear();
		var newdate = day + "/" + month + "/" + year;
		// console.log(newdate);
		return newdate;

	}
	const dateControl = document.querySelector('input[type="date"]');
	function buttonClick() {
		
		// if ("{{report_data}}".hasOwnProperty(dateControl.value)) {
		// 	console.log("true");
		// } else {
		// 	console.log("false");
	var endpoint = '/api';
	// console.log(dateControl.value)
	$.ajax({
		method: "GET",
		url: endpoint,
		success: function (data) {
			// drawLineGraph(data, 'myChartline');
			// drawBarGraph(data, 'myChartBar');
			// console.log(data['']);
			// newData = data[dateformat(dateControl.value)]['1'];
			// department=
			// labels =  ['1','2','3'];
			// chartData = [0,0,0];
			// for (var i = 0; i < newData.length; i++) {
			// 	newData[i]['0'] 
			// }
			// console.log(data[dateformat(dateControl.value)]['1'][0]['0']);
			// console.log(data[dateformat(dateControl.value)]);
			// console.log(data.length);
            if (data[dateformat(dateControl.value)] == undefined){
                const tempData = {
                    "labels": ['1', '2', '3'],
                    'chartLabel': 'Ticket',
                    'chartdata': [0, 0, 0],
                }

                drawBarGraph(tempData, 'myChartBar');
                drawLineGraph(tempData, 'myChartline');
            }
            else{
            drawLineGraph(data[dateformat(dateControl.value)], 'myChartline');
			drawBarGraph(data[dateformat(dateControl.value)], 'myChartBar');
            }
		},
		error: function (error_data) {
			console.log(error_data);
		}
	})
	}
	
	// selectedDate = dateControl.value




	function drawLineGraph(data, id) {
		var labels = data.labels;
		var chartLabel = data.chartLabel;
		var chartdata = data.chartdata;
		var ctx = document.getElementById(id).getContext('2d');
		var chart = new Chart(ctx, {
			// The type of chart we want to create
			type: 'line',

			// The data for our dataset
			data: {
				labels: labels,
				datasets: [{
					label: chartLabel,
					backgroundColor: 'rgb(55, 100, 200)',
					borderColor: 'rgb(255, 255, 255)',
					data: chartdata,
				}]
			},

			// Configuration options go here
			options: {
				scales: {
					xAxes: [{
						display: true
					}],
					yAxes: [{
						ticks: {
							beginAtZero: true
						}
					}]
				}
			}

		});
	}

	function drawBarGraph(data, id) {
		var labels = data.labels;
		var chartLabel = data.chartLabel;
		var chartdata = data.chartdata;
		var ctx = document.getElementById(id).getContext('2d');
		var myChart = new Chart(ctx, {
			type: 'bar',
			data: {
				labels: labels,
				datasets: [{
					label: chartLabel,
					data: chartdata,
					backgroundColor: [
						'rgba(255, 99, 132, 0.5)',
						'rgba(54, 162, 235, 0.5)',
						'rgba(255, 206, 86, 0.5)',
						'rgba(75, 192, 192, 0.5)',
						'rgba(153, 102, 255, 0.5)',
						'rgba(255, 159, 64, 0.5)'
					],
					borderColor: [
						'rgba(255, 99, 132, 1)',
						'rgba(54, 162, 235, 1)',
						'rgba(255, 206, 86, 1)',
						'rgba(75, 192, 192, 1)',
						'rgba(153, 102, 255, 1)',
						'rgba(255, 159, 64, 1)'
					],
					borderWidth: 1
				}]
			},
			options: {
				scales: {
					yAxes: [{
						ticks: {
							beginAtZero: true
						}
					}]
				}
			}
		});
	}
</script>
{% endblock %}